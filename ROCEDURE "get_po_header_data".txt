PROCEDURE "get_po_header_data"( )
   LANGUAGE SQLSCRIPT
   SQL SECURITY INVOKER
   --DEFAULT SCHEMA <default_schema_name>
   READS SQL DATA AS
BEGIN
   /*************************************
       Write your procedure logic
   *************************************/
   SELECT count(*) as create_cnt, "CREATEDBY" FROM
   TABLES_DB_TRANSACTION_PURCHASEORDER WHERE ID IN (
   SELECT "PARENT_KEY_ID" FROM TABLES_DB_TRANSACTION_POITEMS
    WHERE "PRODUCT_GUID_NODE_KEY" IS NOT NULL

   ) GROUP BY CREATEDBY;


   SELECT count(*) as create_cnt, "MODIFIEDBY" FROM
   TABLES_DB_TRANSACTION_PURCHASEORDER WHERE ID IN (
   SELECT "PARENT_KEY_ID" FROM TABLES_DB_TRANSACTION_POITEMS
    WHERE "PRODUCT_GUID_NODE_KEY" IS NOT NULL

   ) GROUP BY MODIFIEDBY;


END
